!function(r,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("xlsx")):"function"==typeof define&&define.amd?define(["xlsx"],t):r.JsExcelTemplate=t(r.XLSX)}(this,function(r){"use strict";function t(r,t){function e(){this.constructor=r}a(r,t),r.prototype=null===t?Object.create(t):(e.prototype=t.prototype,new e)}function e(r){var t="function"==typeof Symbol&&r[Symbol.iterator],e=0;return t?t.call(r):{next:function(){return r&&e>=r.length&&(r=void 0),{value:r&&r[e++],done:!r}}}}function n(r,t){var e="function"==typeof Symbol&&r[Symbol.iterator];if(!e)return r;var n,o,i=e.call(r),f=[];try{for(;(void 0===t||t-- >0)&&!(n=i.next()).done;)f.push(n.value)}catch(r){o={error:r}}finally{try{n&&!n.done&&(e=i.return)&&e.call(i)}finally{if(o)throw o.error}}return f}function o(){for(var r=[],t=0;t<arguments.length;t++)r=r.concat(n(arguments[t]));return r}function i(r){return String.fromCharCode.apply(String,o(new Uint8Array(r)))}function f(r){for(var t=new ArrayBuffer(r.length),e=new Uint8Array(t),n=0;n<r.length;n++)e[n]=255&r.charCodeAt(n);return t}var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,t){r.__proto__=t}||function(r,t){for(var e in t)t.hasOwnProperty(e)&&(r[e]=t[e])};return function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return t(n,e),n.fromArrayBuffer=function(t){var e=btoa(i(t));return new n(r.read(e,{type:"base64",cellNF:!0,cellStyles:!0,cellDates:!0}))},n.prototype.toArrayBuffer=function(t){return f(r.write(this.workbook,{bookType:t,type:"binary"}))},n.prototype.toBlob=function(r){void 0===r&&(r="xlsx");var t=this.toArrayBuffer(r);return new Blob([t],{type:"application/octet-stream"})},n}(function(){function r(r){this.workbook=r}return r.prototype.set=function(r,t){if(Array.isArray(t)){if(0===t.length)return;try{for(var o=e(this.workbook.SheetNames),i=o.next();!i.done;i=o.next()){var f=i.value,a=this.workbook.Sheets[f],l=this.findRowIndex(r,a);if(l>=0){var u=a["!ref"];if(u){var s=n(u.split(":"),2),c=s[0],y=s[1],p=this.parseCellName(y),h=p.column,v=p.rowIndex,d=v+t.length;v>=0&&(a["!ref"]=c+":"+h+d)}for(var w in a)if(a.hasOwnProperty(w)&&0!==w.indexOf("!")){var x=this.parseCellName(w),b=x.column,m=x.rowIndex,g=a[w];if(m===l&&g.w){var O=g.w.indexOf("{"+r+".");if(O>=0){for(var S=void 0,k=O+("{"+r+".").length;k<g.w.length;k++)if("}"===g.w[k]){S=g.w.substring(O+("{"+r+".").length,k);break}if(S){for(k=1;k<t.length;k++)a[b+(m+k)]=JSON.parse(JSON.stringify(a[w]));for(k=0;k<t.length;k++){var N=a[b+(m+k)];this.setCell(N,"{"+r+"."+S+"}",t[k][S])}}}}}return}}}catch(r){_={error:r}}finally{try{i&&!i.done&&(I=o.return)&&I.call(o)}finally{if(_)throw _.error}}}else try{for(var A=e(this.workbook.SheetNames),C=A.next();!C.done;C=A.next()){var f=C.value,a=this.workbook.Sheets[f];for(var w in a)if(a.hasOwnProperty(w)&&0!==w.indexOf("!")){g=a[w];this.setCell(g,"{"+r+"}",t)}}}catch(r){j={error:r}}finally{try{C&&!C.done&&(B=A.return)&&B.call(A)}finally{if(j)throw j.error}}var _,I,j,B},r.prototype.setCell=function(r,t,e){r.v&&"string"==typeof r.v&&r.v.indexOf(t)>=0&&(r.v=r.v===t?e:r.v.split(t).join(e),"number"==typeof r.v?r.t="n":"[object Date]"===Object.prototype.toString.call(r.v)?r.t="d":!0!==r.v&&!1!==r.v||(r.t="b"))},r.prototype.parseCellName=function(r){for(var t=0;t<r.length;t++)if(!isNaN(+r[t]))return{column:r.substring(0,t),rowIndex:+r.substring(t)};return{column:"",rowIndex:-1}},r.prototype.findRowIndex=function(r,t){for(var e in t)if(t.hasOwnProperty(e)&&0!==e.indexOf("!")){var n=t[e];if(n.w&&n.w.indexOf("{"+r+".")>=0)return this.parseCellName(e).rowIndex}return-1},r}())});
